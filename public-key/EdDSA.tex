\subsection{EdDSA и Ed25519}\label{sec:EdDSA}\label{sec:Ed25519}
\selectlanguage{russian}

Схема цифровой подписи EdDSA использует эллиптическую кривую, представленную в скрученной форме Эдвардса (см. раздел~\ref{sec:twisted-edward-curves}). В данной схеме используются следующие параметры:

\begin{itemize}
	\item конечное поле $\F_{p}$, где $p$ -- большое простое число;
	\item группа точек эллиптической кривой в скрученной форме Эдвардса $E$ над полем $\F_{p}$ порядка $Ord(E) = 2^c l$, где $l$ -- большое простое число, $c$ -- целое;
	\item точка, генератор $G$ циклической подгруппы порядка $l$;
	\item криптографическая хэш-функция $H$, имеющая выход $2b$ бит, $b > 1 + log_2 p$, чтобы элементы поля $\F_{p}$ и координаты точек $E$ могли быть представлены в виде $b$-битовых строк.
\end{itemize}

Параметр $l$ должен быть достаточно большим, чтобы $\rho$-метод Полларда для дискретного логарифмирования требовал большого количества операций для вычисления <<логарифма>> -- не менее $\sqrt{l \pi / 4}$ сложений точек в группе. Рекомендуется, чтобы значение $l$ превышало $2^{200}$ -- для получения не менее $\approx 2^{99{,}8}$ сложений точек в $\rho$-методе Полларда.

В качестве закрытого ключа каждый участник выбирает некоторую $b$-битовую строку $k$. Данная строка хэшируется выбранной криптографической хэш-функцией $H$, после чего последние $b$-бит трактуются как целое число в кодировке \foreignlanguage{english}{\textit{little endian}} $s$ и формируется открытый ключ $A \in E$:

\[ \begin{array}{l}
	s = H_{0, \dots, b-1}(k),\\
	A = s \times G.
\end{array} \]

Электронная цифровая подпись $(R, S)$ вычисляется следующим образом:

\begin{enumerate}
	\item $r = H( H_{b,\dots,2b-1}(k) \| M )$ -- аналог случайного параметра $k$ из схемы электронной цифровой подписи Эль-Гамаля;
	\item $R = r \times G$;
	\item $S = r + H( R \| A \| M ) \times s \bmod l$;
\end{enumerate}

Для валидации подписи получатель, знающий параметры схемы и открытый ключ отправителя $A$, проверяет выполнение равенства:

\[
	2^c S \times G = 2^c \times R + 2^c H( R \| A \| M ) \times A.
\]

Корректность схемы можно проверить через раскрытие значения $S$:

\[ \begin{array}{ll}
2^c S \times G & = 2^c ( r + H( R \| A \| M ) \times s ) \times G = \\
               & = 2^c r \times G + 2^c H( R \| A \| M ) s \times G = \\
               & = 2^c R + 2^c H( R \| A \| M ) \times A.
\end{array} \]

Ed25519 задаёт конкретные параметры схемы EdDSA следующим образом (\cite{Bernstein:Duif:Lange:Schwabe:Yang:2011}):

\begin{itemize}
	\item порядок конечного поля является простым числом $p = 2^{255}-19$;
	\item коэффициенты эллиптической кривой в скрученной форме Эдвардса $e = -1$ и $d = \frac{121665}{121666}$:
\[
-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2 \mod p;
\]
	\item базовая точка $G$ имеет координату $y = 4/5 \bmod q$, координата $x$ -- положительная;
	\item порядок базовой точки $G$ является большим простым числом и равен $l = 2^{252} + 27742317777372353535851937790883648493$;
	\item криптографическая хэш-функция SHA-256\index{хэш-функция!SHA-256} ($b = 256$).
\end{itemize}

Выбранная группа точек бирационально эквивалентна группе точек над эллиптической кривой в форме Монтгомери Curve25519 (\cite{Bernstein:2006}). Выбранная базовая точка также соответствует базовой точке, предложенной для Curve25519. Так как сложения в скрученной форме Эдвардса выполняются быстрее, чем в форме Вейерштрасса и в форме Монтгомери, группу Ed25519 можно использовать для ускорения вычислений в тех случаях, когда в качестве параметров выбрана группа точек кривой Curve25519.